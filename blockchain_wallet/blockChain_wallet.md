# 概述：区块链钱包的实现原理及其应用场景
实现原理：区块链钱包的实现原理主要是基于区块链技术的分布式数据库，通过对区块链上的数据进行存储、管理、查询、转移等操作，实现用户的数字资产的管理。

## 钱包类别
1. 中心化钱包：钱包私钥在中心化服务器上，代表是交易所钱包， binance okx bybit
2. 去中心化钱包： 私钥管理在用户的设备，tp imtoken metamask
3. 硬件钱包： 钱包私钥管理在离线的硬件设备上，ledger onekey
4. web3钱包： 
5. 托管钱包： MPC算法，每一个节点一个密钥片，网络中没有完整的私钥出现过，N-M签名方式，总节点为N个，M个节点签名及有效
6. 多签钱包： EVM链一般使用gnosis safe多钱，其他使用密码雪多签
7. 社区回复
8. EVM AA钱包

中心化钱包架构图
业务流程
    - 批量地址生成
    - 充值
    - 提现
    - 归集
    - 热转冷
    - 冷转热
    - 链路风控

- 离线地址生成，离线交易签名和扫快出入金
- 开发-含充值、提现、归集、热转冷、冷转热、链路风控等功能和测试

业务细节流程
- 批量地址生成：交易所钱包为了性能和快速响应用户，所有交易所钱包都会有一个地址池，地址池里面每次生成成千上万的地址，当用户注册到交易所的时直接给用户分配地址，而不是去生成；当地址池里面的地址少于一定数量时就会去新生成一批。
用户->用户交易所注册-请求钱包地址池->交易所钱包分配地址->用户收到地址

- 充值：扫链服务扫区块链，解析区块里面的交易数据，当交易数据里的t0地址是系统用户地址时，说明有充值，充值处理钱包充值扫快，还会风控，解析的时候需要注意防止重复充值。 - 可以构造交易攻击


去中心化钱包
- 收款
- 转账
- 转账记录
- 闪兑
-Dapp浏览器

收款：查询本地设备数据库把地址展示到界面上。
转账: 
    用户发起转账 设备获取签名参数，统一的rpc接口，向区块链网络获取签名参数，签名参数包含转账地址，转账金额，手续费，nonce等信息，然后用户签名，发送到区块链网络。
    区块链网络接收到转账请求，验证签名，执行转账，并广播到所有节点。
    区块链网络广播到所有节点后，节点执行转账，并广播到其他节点。


根据地址查询交易记录和根据 Hash 查询交易详情
闪兑：钱包里面的闪兑一般对接 1inch 或者其他的 aggregator 实现兑换功能
Dapp浏览器：Dapp浏览器是指可以运行Dapp的应用程序，能够正常的和钱包进行交互，有以下几种主流的实现方式 Web View 中包裹 Dapp, 通过 JavaScript 注入 window 对象的方式通信，一般钱包开发直接使用这种方式 websocket 进行 Dapp 和钱包之间的通信

硬件钱包
- 地址生成： BIP， 生成助记词和密钥对，使用公钥导出钱包地址
- 离线签名： 组织交易生成32位msg hash,将签名消息摘要传给硬件，硬件签名后返回，组织交易发送到区块链网络’

对于钱包来说，大家需要更好的掌握交易所钱包，去中心化钱包，硬件钱包和 MPC 托管钱包，目前这四种钱包应用最广泛，工作岗位最多。关于 gnosis safe 多签钱包, AA 钱包等，了解即可，需要使用的时候再学习就行了。话虽然这样说，但是关于 gnosis safe 多签钱包和 AA 钱包，我们在智能合约阶段的课程中也会给大家详细讲解。

值得一说的是，整个钱包课程使用总-分-总的形势铺开，先整体理解钱包的类别，架构以及各模块的实现逻辑，然后再深入讲解钱包的知识细节，最后通过项目实战的形势收回到这篇文章。当然，整个钱包课程也是根据这篇文章展开的，这篇文章的内容也是我们钱包课程第一节课的内容，希望大家有时间好好阅读，深入体会。

## 钱包基础知识
- 术语
助记词： 通过算法从词库中产生 12-21个单词，
随机种子： 使用助记词通过算法产生一个随机字符串
私钥： 钱包中最重要的东西，钱包实际上就对私钥进行管理，主私钥和派生私钥
主私钥： 钱包私钥，游随机种子生成，主私钥被盗的话，你的整个钱包都会被盗
派生私钥： 由主私钥通过bip分层协议生成的私钥，
备份钱包： 其实也叫备份助记词
单链钱包： btc钱包
多链钱包： 支持所有币种的钱包

钱包的作用：将私钥存储在加密文件中并签署交易
用户通常通过接口构建事务对象，将该对象发送到要签名的奇纳堡，然后钱包返回具有签名的该事务对象，


钱包简介： 
1. eth的mist钱包
2. parity rust 钱包全节点钱包
3. myEtherWallet
4. imtoken
5. metaMask
6. ledger
7. 

